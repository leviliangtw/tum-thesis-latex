% !TeX root = ../main.tex
% Add the above to each chapter to make compiling the PDF easier in some editors.

\chapter{Related Work}\label{chapter:related_work}

\section{Using Prometheus for Black Box Monitoring}

The Prometheus Blackbox Exporter is a valuable extension of the Prometheus monitoring system, specifically designed for monitoring external services and endpoints. This tool permits users to probe targets via HTTP, TCP, and ICMP protocols, yielding metrics related to availability, latency, SSL certificate expiration, and DNS resolution, among others. Its configuration options allow for the customization of probe settings, including timeout periods, headers, and probe methods. The metrics gathered are presented in a Prometheus-compatible format, enabling seamless integration with existing Prometheus monitoring setups~\parencite{prometheus_overview_nodate}~\parencite{prometheus_blackbox_2023}. 

The Prometheus community is renowned for its high-quality software, a variety of plugins, and robust support, which can be leveraged when creating a Blackbox Monitoring system. According to a presentation by Aaron Wieczorek titled "Spotlight on Cloud: Using Prometheus for Black Box Monitoring," utilizing a Prometheus Blackbox Exporter based architecture for blackbox monitoring is a practical choice for systems already leveraging Prometheus for monitoring and alerting~\parencite{oreilly_spotlight_nodate}. The following figure depicts the setup: 

However, there are a few challenges. Prometheus' default data retention period is limited to fourteen days because its primary function is real-time system status monitoring and alert delivery. It is not built to retain large amounts of data for extended periods. Furthermore, Prometheus is not designed for a distributed setup, increasing complexity when configuring and deploying each Blackbox Exporter separately, especially during inevitable configuration changes (see Figure 2)~\parencite{prometheus_overview_nodate}. Another critical drawback is that Prometheus acts as a single point of failure, jeopardizing the availability of the monitoring system and risking data loss during a system failure. 

In conclusion, implementing black box monitoring with the Prometheus Blackbox Exporter comes with benefits and drawbacks~\parencite{oreilly_spotlight_nodate}. While it is praised for its simplicity, customization, and extensive community support, it has inherent limitations from its design, constraining its ability to fully exploit the power of a distributed architecture. Data retention for analytics is increasingly vital for ensuring the \ac{SLA} of private services. Without centralized control over all Blackbox Exporters, configuration management can become unwieldy, and the single point of failure inherent in the design presents a risk of data loss. Therefore, careful consideration of these trade-offs is essential in the design and decision-making process of the project. 

\section{Datadog in the Context of Black Box Monitoring Systems}

In the realm of modern IT infrastructure management, monitoring and analytics platforms play an integral role in ensuring system reliability and performance. Among the existing solutions, Datadog has emerged as a prominent player, known for its robust functionalities and capabilities~\parencite{datadog_synthetic_nodate}. In the context of this project, which aims to design a dedicated and distributed black box monitoring system, understanding Datadog's approach and technology is pivotal. 

Datadog offers a unified view of an organization's IT infrastructure by collecting and analyzing data from multiple sources. This approach enables real-time monitoring and troubleshooting, as well as optimization of applications and infrastructure. A standout feature of Datadog is its Synthetic Monitoring, which is particularly applicable for black box monitoring~\parencite{datadog_synthetic_nodate} [Data]. This feature simulates requests and actions, thereby offering insights into the performance of APIs across various network layers, from backend to frontend~\parencite{datadog_api_nodate}~\parencite{datadog_browser_nodate}. 

There are two distinct elements of Datadog's Synthetic Monitoring that are of particular interest: API Tests and Browser Tests~\parencite{datadog_api_nodate}~\parencite{datadog_browser_nodate}. API Tests actively probe target services, gathering their statuses and metrics. These tests offer a snapshot of the availability of the monitored services, a crucial factor in any black box monitoring system. In Datadog's implementation, API Tests form the bulk of the monitoring process, thereby highlighting their importance. Browser Tests, on the other hand, execute defined scenarios on target services using a chosen browser. This essentially reproduces the actions of a user, providing experiential feedback about the services. This user-centric approach complements the more technical data gathered by the API Tests, contributing to a more holistic view of the system's health. 

When it comes to monitoring availability, it is crucial to decide the position of source endpoints that proceed with monitoring~\parencite{datadog_run_nodate}. Datadog provides the feature to customize private locations to execute Synthetic Monitoring. By installing Docker containers as private endpoints in desired locations, Synthetic Monitoring, including both API Tests and Browser Tests, can employ these private endpoints to compose its line of departure. 

While Datadog's synthetic monitoring approach presents a well-rounded solution, it operates primarily within a centralized model in terms of the agents' side. To elaborate, monitoring targets from a private location requires an installed agent in the same cluster, and the agent could be a single point of failure. 

This brings us to the primary focus of our thesis: to explore the feasibility and benefits of a distributed black box monitoring system. As businesses scale and become increasingly distributed, there may be unique advantages to employing a monitoring system that mirrors this distributed structure. By building on the strengths of Datadog's approach, while addressing its potential limitations in distributed environments, we aim to advance the field of black box monitoring. 